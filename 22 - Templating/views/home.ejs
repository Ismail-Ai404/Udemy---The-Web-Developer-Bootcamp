<!-- @format -->

<!DOCTYPE html>
<html lang="en">
     <head>
          <meta charset="UTF-8" />
          <title>Pokédex</title>

          <!-- Bootstrap 5 CSS -->
          <link
               href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
               rel="stylesheet"
               integrity="sha384-EVSTQN3/.../65VohhpuuCOmLASjC"
               crossorigin="anonymous"
          />

          <!-- Custom Retro Styles -->
          <style>
               @font-face {
                    font-family: "ketchum";
                    src: url("/fonts/ketchum.ttf") format("truetype");
               }

               body {
                    background: #a0a0a0;
                    color: #202020;
                    padding: 20px;
               }

               h1 {
                    font-family: "ketchum", sans-serif;
                    font-size: 3em;
                    color: #5e85cc;
                    text-shadow: 3px 3px 0 #eee, 5px 5px 0 #808080;
                    text-align: center;
                    margin-bottom: 30px;
               }

               .pokemon-card {
                    background: #e0e0c0;
                    border: 4px solid #505050;
                    font-family: "ketchum", monospace;
                    text-align: center;
                    padding: 15px;
                    transition: transform 0.2s;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    height: 100%;
               }

               .pokemon-card:hover {
                    transform: scale(1.05);
               }

               .pokemon-card img {
                    width: 96px;
                    margin-bottom: 10px;
               }

               .type-badge {
                    display: inline-block;
                    padding: 5px 10px;
                    border-radius: 5px;
                    color: white;
                    font-weight: bold;
                    text-transform: uppercase;
                    transition: transform 0.3s ease, box-shadow 0.3s ease;
               }

               .type-badge:hover {
                    transform: scale(1.1);
                    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
               }
          </style>
     </head>
     <body>
          <h1>Pokédex</h1>

          <div class="container">
               <div
                    class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4"
               >
                    <% pokemons.forEach(p => { const key = p.name.toLowerCase();
                    %>
                    <!-- Preload the Pokémon cry -->
                    <audio id="sound-<%= key %>">
                         <source
                              src="https://play.pokemonshowdown.com/audio/cries/<%= key %>.mp3"
                              type="audio/mpeg"
                         />
                    </audio>

                    <div class="col">
                         <a href="/info/<%= p.id %>" class="pokemon-link">
                              <div
                                   class="pokemon-card card"
                                   onmouseover="playSound('<%= key %>')"
                                   onmouseout="stopSound('<%= key %>')"
                                   style="
                                        background: linear-gradient(
                                             135deg,
                                             <%=
                                                  typeColors[p.types[0].type.name]
                                                  || '#A8A878' %>,
                                             <%=
                                                  typeColors[p.types[1]?.type.name]
                                                  || '#A8A878' %>
                                        );
                                   "
                              >
                                   <h2>
                                        #<%= String(p.id).padStart(4, "0") %> —
                                        <%= p.name.toUpperCase() %>
                                   </h2>
                                   <img
                                        src="<%= p.sprites.front_default %>"
                                        alt="<%= p.name %>"
                                   />
                                   <p>
                                        <% p.types.forEach(function(t) { %>

                                        <span
                                             class="type-badge"
                                             style="
                                                  background: <%=
                                                       typeGradients[t.type.name]
                                                       ||
                                                       'linear-gradient(to right, #A8A878, #E0E0A0)'
                                                       %>;
                                             "
                                        >
                                             <%= t.type.name.toUpperCase() %>
                                        </span>

                                        <% }); %>
                                   </p>
                              </div>
                         </a>
                    </div>
                    <% }); %>
               </div>
          </div>

          <!-- JavaScript for hover audio -->
          <script>
               function playSound(name) {
                    const audio = document.getElementById(`sound-${name}`);
                    if (audio) {
                         audio.currentTime = 0;
                         audio.volume = 0.5;
                         audio.play();
                    }
               }

               function stopSound(name) {
                    const audio = document.getElementById(`sound-${name}`);
                    if (audio) {
                         audio.pause();
                         audio.currentTime = 0;
                    }
               }
          </script>

          <!-- Bootstrap JS (optional) -->
          <script
               src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
               integrity="sha384-MrcW...49e"
               crossorigin="anonymous"
          ></script>
     </body>
</html>
